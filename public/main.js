import{j as C,r as s,u as T,L as S,B as P,R as U,a as N,b as O,c as R}from"./chunks/vendor.js";const e=C.exports.jsx,n=C.exports.jsxs,L=C.exports.Fragment;function E(t){return e("div",{className:`card ${t.className}`,children:t.children})}function A(){return n(E,{className:"home-container",children:[e("h1",{children:"Duit"}),e("h3",{children:"Track your job applications easily"})]})}function f(t){return n("div",{className:`formfield ${t.size?t.size:""}`,children:[e("label",{htmlFor:t.name,children:t.label}),e("input",{id:t.name,type:t.type,onChange:i=>t.onValueChange(i.target.value)})]})}function b(t){return e("button",{className:`formbutton ${t.iconButton?t.iconButton:""}`,onClick:t.onClickHandler,children:t.name})}function B(){const[t,i]=s.exports.useState([]),[u,c]=s.exports.useState(""),[p,m]=s.exports.useState(""),[l,d]=s.exports.useState("");async function w(){let a=await fetch("/api/applications");a=await a.json(),console.log(a),i(a)}async function v(){let a=t,g={company:p,title:l,url:u,status:!1},h=await fetch("/api/application",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(g)});h=await h.json(),a.push(h),i([...a]),c(""),m(""),d("")}async function o(a,g){let h=t,x={};h.forEach(j=>{j._id==a&&(j.status=g,x=j)});let y=await fetch("/api/application",{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(x)});y=await y.json(),console.log(t),i([...h])}async function r(a){let g=[],h={};t.forEach(y=>{y._id==a?h=y:g.push(y)});let x=await fetch("/api/application",{method:"DELETE",headers:{"content-type":"application/json"},body:JSON.stringify(h)});x=await x.json(),console.log(t),i([...g])}return s.exports.useEffect(()=>{w()},[]),n("div",{className:"application-wrapper",children:[n("div",{className:"add-application",children:[e(f,{name:"company",label:"Company",type:"text",size:"small",onValueChange:a=>{m(a)}}),e(f,{name:"title",label:"Title",type:"text",size:"medium",onValueChange:a=>{d(a)}}),e(f,{name:"url",label:"Job Posting URL",type:"text",size:"large",onValueChange:a=>{c(a)}}),e("div",{children:e(b,{iconButton:"add-icon",name:"+",onClickHandler:v})})]}),e("div",{className:"application-list",children:t.map(a=>n("details",{className:"application-card",children:[n("summary",{children:[e("span",{className:a.status?"summary-status applied":"summary-status not-applied",onClick:g=>{g.preventDefault(),o(a._id,!a.status)}}),n("span",{className:"summary-company",children:[e("b",{children:"Company: "}),a.company]}),n("span",{className:"summary-title",children:[e("b",{children:"Title: "})," ",a.title]}),e(b,{iconButton:"trash-icon",name:" ",onClickHandler:()=>{r(a._id)}})]}),n("div",{className:"application-details",children:[n("h3",{children:["Company: ",a.company]}),n("h3",{children:["Title: ",a.title]}),n("h3",{children:["URL: ",a.url]})]})]},a._id))})]})}function H(){return e("main",{children:"Profile"})}function k(t){const[i,u]=s.exports.useState(!1),[c,p]=s.exports.useState(""),[m,l]=s.exports.useState(""),[d,w]=s.exports.useState(""),v=T();s.exports.useEffect(()=>{});async function o(){let r=await fetch("/api/login",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:m,password:d})});r=await r.json(),console.log(r),u(!0),p(r.msg?r.msg:""),r.status?setTimeout(()=>{u(!1),p(""),t.setLogin(!0),v("/")},1500):setTimeout(()=>{u(!1),p("")},1500)}return n(E,{className:"signup-container",children:[e("h1",{children:"Login"}),i?e("h3",{children:c}):n(L,{children:[e(f,{name:"email",label:"Email",type:"email",onValueChange:r=>{l(r)}}),e(f,{name:"password",label:"Password",type:"password",onValueChange:r=>{w(r)}}),e(b,{name:"Login",onClickHandler:o})]})]})}function M(){const[t,i]=s.exports.useState(!1),[u,c]=s.exports.useState(""),[p,m]=s.exports.useState(""),[l,d]=s.exports.useState(""),w=T();s.exports.useEffect(()=>{});async function v(){let o=await fetch("/api/signup",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:p,password:l})});o=await o.json(),console.log(o),i(!!o._id),c(o.msg?o.msg:""),o.status?setTimeout(()=>{i(!1),c(""),w("/login")},1500):setTimeout(()=>{i(!1),c("")},1500)}return n(E,{className:"signup-container",children:[e("h1",{children:"Sign Up"}),t?e("h3",{children:u}):n(L,{children:[e(f,{name:"email",label:"Email",type:"email",onValueChange:o=>{m(o)}}),e(f,{name:"password",label:"Password",type:"password",onValueChange:o=>{d(o)}}),e(b,{name:"Sign Up",onClickHandler:v})]})]})}function V(t){return n("div",{className:"header",children:[e("div",{className:"left",children:"Duit"}),n("nav",{className:"right",children:[e(S,{to:"/",children:e("span",{children:"Home"})}),e(S,{to:"/applications",children:e("span",{children:"Applications"})}),e(S,{to:"/signup",children:e("span",{children:"Sign Up"})}),t.loggedIn?e(S,{to:"",children:e("span",{onClick:t.logout,children:"Logout"})}):e(S,{to:"/login",children:e("span",{children:"Login"})})]})]})}function I(){const[t,i]=s.exports.useState(!1),[u,c]=s.exports.useState(!0);async function p(){let d=await(await fetch("/loggedIn")).json();return c(!1),Promise.resolve(d.status)}async function m(){let d=await(await fetch("/logout")).json();console.log(d.status),window.location.reload()}return s.exports.useEffect(()=>{p().then(l=>{i(l)})},[]),e(L,{children:n(P,{children:[e(V,{loggedIn:t,logout:m}),u?e("main",{}):e("main",{children:n(U,{children:[e(N,{path:"/",element:e(A,{})}),e(N,{path:"/applications",element:t?e(B,{}):e(k,{setLogin:l=>i(l)})}),e(N,{path:"/profile",element:e(H,{})}),e(N,{path:"/login",element:e(k,{setLogin:l=>i(l)})}),e(N,{path:"/signup",element:e(M,{})})]})})]})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"})});O.render(e(R.StrictMode,{children:e(I,{})}),document.getElementById("duit-app"));
